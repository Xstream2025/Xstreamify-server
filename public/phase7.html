<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>X-Streamify</title>

  <link href="/tailwind.css" rel="stylesheet" />
  <script defer src="/js/phase7.js"></script>
</head>
<body class="bg-black text-white font-sans">
  <!-- Header -->
  <header class="w-full bg-[#151515]/95 backdrop-blur border-b border-white/10">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <div class="w-8 h-8 rounded-xl bg-red-600 grid place-items-center text-white text-xl font-black">X</div>
        <span class="text-lg font-semibold">X-Streamify</span>
      </div>
      <nav class="hidden md:flex items-center space-x-6 text-white/80">
        <a href="#featured" class="hover:text-white">Featured</a>
        <a href="#library" class="hover:text-white">My Library</a>
        <a href="#how" class="hover:text-white">How It Works</a>
        <a href="#vault" class="hover:text-white">Your Vault</a>
      </nav>
      <button id="add-movie-btn" class="hidden md:block bg-red-600 text-white px-4 py-2 rounded-2xl font-medium">
        + Add New Movie
      </button>
    </div>
  </header>

  <!-- Hero -->
  <section class="relative max-w-7xl mx-auto px-4 pt-24 pb-16 grid md:grid-cols-[1fr,380px] gap-10">
    <div>
      <h1 class="text-5xl md:text-6xl font-extrabold tracking-tight mb-6">
        Build your personal streaming library.
      </h1>

      <div class="flex items-stretch gap-3 max-w-2xl">
        <input type="text" placeholder="Search..." class="flex-1 rounded-xl px-4 py-3 text-black focus:outline-none" />
        <button class="bg-red-600 rounded-xl px-4 py-3 font-medium">Search</button>
      </div>

      <div class="flex items-center gap-3 mt-5 text-sm">
        <span class="inline-flex items-center gap-2 bg-[#1e1e1e] px-3 py-1.5 rounded-2xl">üé¨ Featured</span>
        <span class="inline-flex items-center gap-2 bg-[#1e1e1e] px-3 py-1.5 rounded-2xl">üìö My Library</span>
        <span class="inline-flex items-center gap-2 bg-[#1e1e1e] px-3 py-1.5 rounded-2xl">‚ùì How It Works</span>
      </div>
    </div>

    <aside class="hidden md:block">
      <div class="h-[420px] rounded-3xl border-2 border-red-600/70 p-4">
        <div class="w-full h-full rounded-2xl border border-red-600/60 grid place-items-center text-red-400">
          Poster
        </div>
      </div>
    </aside>
  </section>

  <!-- Featured -->
  <section id="featured" class="max-w-7xl mx-auto px-4 pb-12">
    <h2 class="text-2xl font-semibold mb-4">Featured</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="bg-[#232323] text-center py-6 rounded-2xl">Feature A</div>
      <div class="bg-[#232323] text-center py-6 rounded-2xl">Feature B</div>
      <div class="bg-[#232323] text-center py-6 rounded-2xl">Feature C</div>
    </div>
  </section>

  <!-- My Library -->
  <section id="library" class="max-w-7xl mx-auto px-4 pb-12">
    <h2 class="text-2xl font-semibold mb-4">My Library</h2>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
      <div class="bg-[#232323] h-40 rounded-2xl"></div>
      <div class="bg-[#232323] h-40 rounded-2xl"></div>
      <div class="bg-[#232323] h-40 rounded-2xl"></div>
      <div class="bg-[#232323] h-40 rounded-2xl"></div>
    </div>
  </section>

  <!-- How It Works -->
  <section id="how" class="max-w-7xl mx-auto px-4 pb-12">
    <h2 class="text-2xl font-semibold mb-4">How It Works</h2>
    <ol class="space-y-2 text-white/80">
      <li>1. Insert your disc or upload your file.</li>
      <li>2. Our system processes and stores your media securely.</li>
      <li>3. Stream your movies anytime, anywhere.</li>
    </ol>
  </section>

  <!-- Add a New Movie -->
  <section class="max-w-7xl mx-auto px-4 pb-12">
    <h2 class="text-2xl font-semibold mb-4">Add a New Movie</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <button class="bg-[#232323] h-16 rounded-2xl grid place-items-center">Import Disc</button>
      <button class="bg-[#232323] h-16 rounded-2xl grid place-items-center">Upload File</button>
    </div>
  </section>

  <!-- Your Vault -->
  <section id="vault" class="max-w-7xl mx-auto px-4 pb-16">
    <div class="flex items-center justify-between">
      <h2 class="text-2xl font-semibold">Your Vault</h2>
      <div class="inline-flex rounded-full bg-[#1a1a1a] p-1">
        <button id="tab-all" class="px-3 py-1 rounded-full text-sm font-medium text-white bg-red-600">All</button>
        <button id="tab-recent" class="px-3 py-1 rounded-full text-sm font-medium text-white/70 hover:text-white">Recently Added</button>
        <button id="tab-favs" class="px-3 py-1 rounded-full text-sm font-medium text-white/70 hover:text-white">Favorites</button>
      </div>
    </div>

    <!-- Anchor + Grid -->
    <div id="vault-anchor" class="h-0"></div>
    <div id="vault-grid" class="mt-4 grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 gap-6"></div>
  </section>

  <!-- Add Movie Modal -->
  <div id="add-movie-modal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/60" data-close="1"></div>
    <div class="relative mx-auto mt-24 w-[92%] max-w-lg rounded-2xl bg-[#1a1a1a] p-4 shadow-xl">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-xl font-semibold">Add New Movie</h3>
        <button id="close-add-movie" class="text-white/70 hover:text-white text-2xl leading-none">&times;</button>
      </div>
      <p class="text-white/70 mb-4">This is the modal shell. We‚Äôll wire up fields in Phase 9.</p>
      <div class="flex justify-end gap-2">
        <button id="cancel-add-movie" class="px-4 py-2 rounded-xl bg-[#2a2a2a]">Cancel</button>
        <button class="px-4 py-2 rounded-xl bg-red-600">Save</button>
      </div>
    </div>
  </div>

  <!-- Inline helpers: modal + vault anchoring + tabs filtering -->
  <script>
    // ---- Modal open/close ----
    (function () {
      const openBtn = document.getElementById('add-movie-btn');
      const modal = document.getElementById('add-movie-modal');
      const closeBtn = document.getElementById('close-add-movie');
      const cancelBtn = document.getElementById('cancel-add-movie');
      const backdrop = modal.querySelector('[data-close]');
      function open() { modal.classList.remove('hidden'); document.body.classList.add('overflow-hidden'); }
      function close() { modal.classList.add('hidden'); document.body.classList.remove('overflow-hidden'); }
      if (openBtn) openBtn.addEventListener('click', open);
      if (closeBtn) closeBtn.addEventListener('click', close);
      if (cancelBtn) cancelBtn.addEventListener('click', close);
      if (backdrop) backdrop.addEventListener('click', close);
      window.addEventListener('keydown', (e) => { if (e.key === 'Escape' && !modal.classList.contains('hidden')) close(); });
    })();

    // ---- Vault anchoring & renderer ----
    (function () {
      function findVaultGrid() {
        const byId = document.querySelector('#vault-grid');
        if (byId) return byId;
        const section = document.querySelector('#vault');
        if (section) {
          const g = section.querySelector('.grid');
          if (g) return g;
        }
        const h2 = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.trim().toLowerCase() === 'your vault');
        if (h2) {
          const root = h2.parentElement;
          const tryFind = (n) => (n ? n.querySelector('.grid') : null);
          return tryFind(root) || tryFind(root.nextElementSibling) || tryFind(root.parentElement);
        }
        return document.querySelector('.grid') || document.body;
      }

      window.renderVaultCards = function(items) {
        const grid = findVaultGrid();
        if (!grid) return;
        grid.innerHTML = '';
        items.forEach(item => {
          const card = document.createElement('div');
          card.className = 'xsm-card rounded-2xl overflow-hidden bg-[#121212]';
          const poster = item.poster ? `<img src="${item.poster}" alt="${item.title}" class="w-full h-full object-cover">` : '';
          card.innerHTML = `
            <div class="aspect-[2/3] bg-black/40">${poster}</div>
            <div class="p-2">
              <p class="text-white text-sm truncate">${item.title}</p>
            </div>`;
          grid.appendChild(card);
        });
      };
    })();

    // ---- Tabs filtering ----
    (function () {
      const $all = document.getElementById('tab-all');
      const $recent = document.getElementById('tab-recent');
      const $favs = document.getElementById('tab-favs');

      // Demo data (you can replace with real data later)
      const now = Date.now();
      window.vaultItems = [
        { id: 1, title: 'Braveheart',   poster: 'https://image.tmdb.org/t/p/w342/or1gBugydmjToAEq7OZY0owwFk.jpg', addedAt: now - 1000*60*60*24*40, favorite: false }, // 40 days ago
        { id: 2, title: 'The Matrix',   poster: 'https://image.tmdb.org/t/p/w342/f89U3ADr1oiB1s9GkdPOEpXUk5H.jpg', addedAt: now - 1000*60*60*24*3,  favorite: true  }, // 3 days ago
        { id: 3, title: 'Blade Runner', poster: 'https://image.tmdb.org/t/p/w342/63N9uy8nd9j7Eog2axPQ8lbr3Wj.jpg', addedAt: now - 1000*60*60*24*8,  favorite: false }  // 8 days ago
      ];

      function setActive(btn) {
        [$all, $recent, $favs].forEach(b => b.classList.remove('bg-red-600','text-white'));
        [$all, $recent, $favs].forEach(b => b.classList.add('text-white/70'));
        btn.classList.remove('text-white/70');
        btn.classList.add('bg-red-600','text-white');
      }

      function applyFilter(kind) {
        const items = window.vaultItems || [];
        if (kind === 'all') {
          window.renderVaultCards(items);
        } else if (kind === 'recent') {
          const thirtyDays = 1000*60*60*24*30;
          window.renderVaultCards(items.filter(i => (now - i.addedAt) <= thirtyDays));
        } else if (kind === 'favs') {
          window.renderVaultCards(items.filter(i => i.favorite));
        }
      }

      // Wire up events
      if ($all)   $all.addEventListener('click',   () => { setActive($all);   applyFilter('all');   });
      if ($recent)$recent.addEventListener('click',() => { setActive($recent);applyFilter('recent');});
      if ($favs)  $favs.addEventListener('click',  () => { setActive($favs);  applyFilter('favs');  });

      // Initial render (All)
      setActive($all);
      applyFilter('all');

      // Expose helpers for quick testing in Console
      window.Vault = {
        fav: (id, on=true) => {
          const it = (window.vaultItems||[]).find(i=>i.id===id);
          if (it) it.favorite = !!on;
          const active = document.querySelector('#tab-favs.bg-red-600') ? 'favs'
                        : document.querySelector('#tab-recent.bg-red-600') ? 'recent'
                        : 'all';
          applyFilter(active);
        },
        addRecentDemo: () => {
          const id = Math.max(...window.vaultItems.map(i=>i.id))+1;
          window.vaultItems.unshift({
            id, title: 'New Movie '+id, poster: '', addedAt: Date.now(), favorite: false
          });
          applyFilter('recent'); setActive($recent);
        }
      };
    })();
  </script>
</body>
</html>
